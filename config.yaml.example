# PET-CT Radiomics Pipeline Configuration
# Copy this file to config.yaml and customize as needed
#
# 肺PET/CT解析パイプライン設定ファイル
# このファイルをconfig.yamlとしてコピーして使用してください

# ==============================================================================
# MODALITIES
# ==============================================================================
# Supported: CT, PET, MR, SPECT
modalities:
  - CT
  - PET

# ==============================================================================
# TARGET ORGANS
# ==============================================================================
# TotalSegmentator supports 104 anatomical structures
# Use 'all' to process all available organs
# Or specify a custom list below

# DEFAULT: Clinical standard organ set for PET analysis
# 臨床標準臓器セット（PET解析用）
organs:
  # 肝臓 - 大きな臓器（安定したセグメンテーション）
  - liver

  # 両側腎 - 中サイズ臓器（生理的集積）
  - kidney_left
  - kidney_right

  # 両側副腎 - 小臓器（部分容積効果の影響を受けやすい）
  - adrenal_gland_left
  - adrenal_gland_right

  # L1椎体 - 骨髄参照
  - vertebrae_L1

  # 大動脈 - 血液プール参照
  - aorta

  # 左肺（上葉・下葉）
  - lung_upper_lobe_left
  - lung_lower_lobe_left

# ------------------------------------------------------------------------------
# ALTERNATIVE: All 104 organs
# ------------------------------------------------------------------------------
# organs:
#   - all

# ------------------------------------------------------------------------------
# ALTERNATIVE: Full lung lobes (bilateral)
# ------------------------------------------------------------------------------
# organs:
#   - lung_upper_lobe_left
#   - lung_lower_lobe_left
#   - lung_upper_lobe_right
#   - lung_middle_lobe_right
#   - lung_lower_lobe_right
#   - liver
#   - spleen

# ------------------------------------------------------------------------------
# ALTERNATIVE: Extended organ set
# ------------------------------------------------------------------------------
# organs:
#   - liver
#   - spleen
#   - kidney_left
#   - kidney_right
#   - adrenal_gland_left
#   - adrenal_gland_right
#   - aorta
#   - vertebrae_L1
#   - lung_upper_lobe_left
#   - lung_lower_lobe_left
#   - lung_upper_lobe_right
#   - lung_middle_lobe_right
#   - lung_lower_lobe_right

# ==============================================================================
# DICOM SERIES SELECTION
# ==============================================================================
# Auto-select appropriate CT and PET series from multi-series data
# DICOMシリーズ自動選別設定
dicom_selection:
  # Enable automatic series selection
  # 複数シリーズがある場合に本体CT/PETを自動選択
  auto_select: true

  # Minimum slice count for CT (excludes Dose Report, Localizer, etc.)
  # CTの最小スライス数（レポート等を除外）
  min_ct_slices: 100

  # Minimum slice count for PET (excludes MIP, reports)
  # PETの最小スライス数（MIP、レポートを除外）
  min_pet_slices: 50

# ==============================================================================
# SEGMENTATION SETTINGS
# ==============================================================================
segmentation:
  # TotalSegmentator task per modality
  tasks:
    CT: total           # Standard CT segmentation
    MR: total_mr        # MR-specific model
    PET: use_ct_mask    # Use CT-derived masks for PET
    SPECT: use_ct_mask  # Use CT-derived masks for SPECT

  # Fast mode: Lower resolution, faster processing (~90 sec vs ~3 min)
  # Recommended for routine use; disable for maximum accuracy
  fast: true

  # ROI subset: Limit TotalSegmentator output to specific organs
  # null = extract all 104 organs (recommended)
  # List specific organs to reduce disk usage
  roi_subset: null

# ==============================================================================
# OUTPUT SETTINGS
# ==============================================================================
output:
  # Output CSV filename
  csv_file: radiomics_results.csv

  # Include PyRadiomics diagnostic features (image hash, mask stats, etc.)
  # Set to true for debugging; false for cleaner output
  include_diagnostics: false

# ==============================================================================
# VISUALIZATION SETTINGS
# ==============================================================================
visualization:
  # CT window settings for mediastinal window
  # 縦隔条件 (mediastinal window)
  ct_window:
    level: 40    # Window level (HU)
    width: 400   # Window width (HU)

  # PET colormap
  pet_colormap: hot

  # PET SUV range for display
  pet_suv_range:
    min: 0
    max: 10

  # Mask overlay alpha
  mask_alpha: 0.3

# ==============================================================================
# ADVANCED SETTINGS (Optional)
# ==============================================================================
# Uncomment and modify as needed

# spatial_alignment:
#   # PET-to-CT alignment using NIfTI world coordinates (affine transformation)
#   # Note: NOT de novo registration - uses pre-aligned integrated PET/CT data
#   interpolation: Linear   # For PET resampling (order=1 in nibabel)

# radiomics:
#   bin_width: 0.25         # SUV bin width for texture features (see params.yaml)
#   resegment_range: null   # [min, max] to exclude values outside range
#   normalize: false        # Normalize image before extraction
