# PET-CT Radiomics Pipeline - Linux (GPU) Environment
# YCU DeepStation等、CUDA GPU環境用
#
# 使用方法:
#   conda env create -f environment_linux.yml
#   conda activate med_pet2
#
# 注意: pytorch-cuda バージョンは環境のCUDAバージョンに合わせて変更

name: med_pet2
channels:
  - conda-forge
  - pytorch
  - nvidia
  - defaults

dependencies:
  # Python
  - python=3.10

  # --- 重要: バージョン固定 ---
  # NumPy: 1.x系を使用（NumPy 2.xはPyTorch/TotalSegmentatorと非互換）
  - numpy>=1.26,<2.0

  # PyTorch with CUDA: 2.4以上を推奨（torch._dynamo互換性のため）
  - pytorch>=2.4
  - torchvision
  - pytorch-cuda=12.1  # CUDAバージョンに合わせて変更（11.8, 12.1, 12.4等）

  # 基本ライブラリ
  - pandas>=2.0
  - matplotlib>=3.7
  - pyyaml>=6.0
  - scipy>=1.10
  - scikit-learn>=1.3
  - scikit-image>=0.21
  - pillow>=10.0
  - tqdm

  # 医療画像処理（conda-forge）
  - simpleitk>=2.3
  - nibabel>=5.0

  - pip
  - pip:
    # DICOM処理
    - pydicom>=2.4
    - dicom2nifti>=2.4
    - python-gdcm>=3.0

    # セグメンテーション
    - TotalSegmentator>=2.0,<3.0

    # Radiomics特徴量抽出
    - pyradiomics>=3.0,<4.0

    # 可視化
    - seaborn>=0.12
    - imageio>=2.30
